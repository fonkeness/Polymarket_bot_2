# Как скачать все сделки (трейды) из Polymarket API

## Ответ на ваш вопрос

**Да, вы можете скачать весь список сделок через API!** 

Hashdive.com использует Polymarket API для получения данных. Вместо того чтобы скачивать по одному листу (как на hashdive.com), вы можете использовать скрипт для автоматической загрузки всех сделок через Polymarket API с пагинацией.

## Как использовать

### Шаг 1: Получите Market ID

Market ID - это идентификатор рынка на Polymarket (обычно начинается с `0x...`).

**Вариант A: Через браузер на hashdive.com**
1. Откройте страницу на hashdive.com (например, вашу ссылку)
2. Нажмите F12 для открытия DevTools
3. Перейдите на вкладку Network (Сеть)
4. Обновите страницу или загрузите данные
5. Найдите API запросы к Polymarket API
6. В запросах найдите параметр `market` - это и есть Market ID

**Вариант B: Через Polymarket.com**
1. Перейдите на https://polymarket.com
2. Найдите нужный рынок
3. Откройте страницу рынка
4. Market ID обычно виден в URL или в исходном коде страницы

**Вариант C: Использовать helper скрипт**
```bash
python scripts/get_market_id_from_hashdive.py "https://hashdive.com/Analyze_Market?market=Epstein+client+list+released+in+2025%3F"
```

### Шаг 2: Запустите скрипт для загрузки всех сделок

```bash
python scripts/fetch_all_trades.py <market_id>
```

Пример:
```bash
python scripts/fetch_all_trades.py 0x1234567890abcdef...
```

### Шаг 3: Скрипт автоматически:

1. ✅ Загрузит все сделки с пагинацией (все 500+ листов)
2. ✅ Сохранит их в базу данных SQLite (`data/trades.db`)
3. ✅ Покажет прогресс загрузки
4. ✅ Отобразит итоговое количество загруженных сделок

### Дополнительные опции

**Только загрузить без сохранения в БД:**
```bash
python scripts/fetch_all_trades.py <market_id> --no-db
```

## Как это работает

Скрипт использует Polymarket API с поддержкой пагинации:
- Делает запросы по 500 сделок за раз (максимум для API)
- Использует `cursor` для получения следующей страницы
- Продолжает загрузку пока есть данные
- Автоматически обрабатывает все страницы

## Где находятся данные

После выполнения скрипта, все сделки сохраняются в:
- **База данных**: `data/trades.db` (SQLite)
- **Таблица**: `trades`
- **Поля**: timestamp, price, size, trader_address, market_id

Вы можете использовать базу данных для дальнейшего анализа или экспорта в Excel/CSV.

## Преимущества по сравнению с hashdive.com

✅ Автоматическая загрузка всех страниц (не нужно скачивать по одной)  
✅ Данные сохраняются в структурированную базу данных  
✅ Можно автоматизировать процесс  
✅ Прямой доступ к актуальным данным через API  

## Примечания

- API имеет ограничения по скорости (rate limiting) - скрипт автоматически их соблюдает
- Если рынок имеет очень много сделок (десятки тысяч), загрузка может занять некоторое время
- Все данные сохраняются локально, вы полностью контролируете свои данные


